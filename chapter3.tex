\section{Структуризация данных}
\subsection{Исходные данные}
Для получения необработанных данных использовалось названое ранее хранилище репозиториев~-- GitHub. Было склонировано несколько репозиториев для последующего обзора. История этих репозиториев анализировалась с помощью встроенных в Git комманд (например, git log). Система контроля версий Git выдает историю репозитория, начиная от самых новых коммитов к самым старым. Чтобы упростить анализ, был проведен анализ истории от последних коммитов к самым первым для более простого отслеживания удаления и переименования файлов.
\subsection{Тренировочный датасет}
Когда история репозитория получена, возникает вопрос~-- как определить, какие файлы следует рекомендовать для каждого коммита в истории.
\subsubsection{Формат датасета}
Опишем, как выглядит набор данных. Датасет состоит из строк, где любая отдельная строка содержит несколько частей:
    \begin{itemize}
		\item Информация о коммите: автор коммита, время коммита, файлы в нем и т.д.
		\item Файл из репозитория.
		\item Единица, если файл должен быть предсказан, иначе~-- ноль.
	\end{itemize}
\subsubsection{Лемма о полном коммите}
Сделаем такое предположение: большинство коммитов в любом репозитории уже содержат полный набор файлов. Учитывая, что коммитов много, коммиты с неполным набором файлов не повлияют на качество рекомендаций.
\subsubsection{Цель}
Если коммит, взятый из репозитория, имеет полный набор файлов, то при удалении файла из этого коммита набор будет неполным. Поэтому цель строится следующим образом: для каждого коммита размера $N$ каждое из его подмножеств размера $N - 1$ берется в качестве первой части, а оставшийся файл считается правильным выходным сигналом~-- второй частью строчки датасета. В то же время, система не должна ничего рекомендовать для оригинального коммита, поэтому необходимо добавить в датасет некоторое количество строк, где первая часть является текущим коммитом, а вторая часть содержит <<связанный>> файл не из текущего коммита. У такой строчки цель будет равно нулю. <<Связанный>> файл~-- это файл, который был в одном и том же коммите с любым из файлов из текущего коммита хотя бы один раз.
\subsection{Тестовый датасет}
Тестовый набор данных имеет тот же формат, что и обучающий набор данных. Самое главное~-- никогда не проверять качество системы на данных, которые использовались для обучения этой системы. Поэтому проводится проверка каждого репозитория на $k$ последних коммитах и обучение его на остальной истории. Это также имеет и практическое значение~-- наша система всегда будет обучаться на данных, полученных в прошлом: значит нам нужно хорошо уметь делать рекомендации в будущем.
\subsection{Оценка качества}
Главная цель нашей системы~-- рекомендовать полный набор файлов по данному коммиту. Следует отметить, что когда разработчик использует нашу систему, важно не давать неверные рекомендации. Если система не уверена в конкретной рекомендации, то лучше молчать, чем нарушать рабочий процесс разработчика. Исходя из этого предположения, система должна попытаться свести к минимуму количество ложных срабатываний и максимально увеличить количество истинных положительных результатов. Необходимо подумать о том, насколько хороши рекомендации нашей модели со стороны пользователя. Обучающие и тестовые наборы данных были созданы для репозитория IntelliJ IDEA Community. Система рекомендаций по файлам была протестирована на последних 5000 коммитах и обучена на остальных коммитах.
\section{Экспериментальная среда}
\section{Базовый показатель}\label{baseline}
Простейшим базовым показателем для нашей системы является получение <<связанных>> файлов, для каждого файла этого набора подсчитайте количество коммитов, в которых содержался этот файл, и порекомендуйте пять файлов с наибольшим числом. %TODO бессмысленно
\section{Ассоциативные правила}
Первыми алгоритмами машинного обучения для решения поставленной задачи были выбраны ассоциативные правила. Использовался алгоритм Apriori. Максимальное качество, которое получилось получить, подбирая различные гиперпараметры модели, точность -- 0.31. 
\begin{table}[!h]
\caption{Точность части исследованных моделей на ассоциативных правил}\label{ar-offline-result-table}
\centering
\begin{tabular}{|l|c|}\hline
\multicolumn{1}{|c|}{\textbf{Модель ассоциативных правил}} & \textbf{Точность}\\\hline
Граница применения 0,25; размер набора 3; поддержка 0,08 & 0,18\\\hline
Граница применения 0,25; размер набора 5; поддержка 0,01  & 0,24 \\\hline
Граница применения 0,25; размер набора 3; поддержка 0,1  & 0,22\\\hline
\end{tabular}
\end{table}
\section{Баесовское среднее}
Для каждого файла из текущего коммита 20 последних коммитов, содержащих этот файл, извлекаются из истории. После этого каждый из этих извлеченных коммитов голосует за файлы, содержащиеся в нем (исключая файлы от текущего коммита). Величина голоса рассчитывается по формуле: $\min(1.0, \frac{{commit\_size}}{{size}})$\\
$commits\_size$ --  максимальное число файлов в голосующем коммите, чтобы получить максимальную величину голоса $= 8.0$,\\
$size$ -- число файлов в голосующем коммите\\
Результаты из разных файлов складываются. Файл будет рекомендован, если его оценка выше чем порог $= 0,55$.
\subsection{Оценка качества на созданном наборе данных}
\begin{table}[!h]
\caption{Точность части исследованных моделей на основе Байесовского среднего}\label{bayes-offline-result-table}
\centering
\begin{tabular}{|l|c|}\hline
\multicolumn{1}{|c|}{\textbf{Функция голоса}} & \textbf{Точность}\\\hline
Количество файлов в коммите & 0,47\\\hline
Количество файлов в коммите с ограничением  & \uline{0,53} \\\hline
Взвешанное расстояние по времени от текущего коммита  & 0,32\\\hline
Константный голос  & 0,31\\\hline
Линейная комбинация предыдущих функций голоса  & 0,42\\\hline
\end{tabular}
\end{table}
\subsection{Оценка качества на основе собранной статистики}
\section{Случайный лес}
\subsection{Признаки}
Признаки отобранные при обучении случайного леса:
\begin{itemize}
    \item Максимальное значение функции $f(file)$, для всех файлов из пользовательского коммита, где $f$~-- это число коммитов, где файл $file$ и кандидат на предсказание были вместе модифицированы.
    \item Сумма значений функции $f(file)$, для всех файлов из пользовательского коммита, где $f$~-- это число коммитов, где файл $file$ и кандидат на предсказание были вместе модифицированы.
    \item Минимальное расстояние между пользовательским коммитом и коммитом из истории репозитория, где были модифицированы файл из коммита и кандидат на рекомендацию.
    \item Максимальное расстояние между пользовательским коммитом и коммитом из истории репозитория, где были модифицированы файл из коммита и кандидат на рекомендацию.
    \item Среднее расстояние между пользовательским коммитом и коммитом из истории репозитория, где были модифицированы файл из коммита и кандидат на рекомендацию.
    \item Число файлов в пользовательском коммите.
    \item Совершал ли автор пользовательского коммита коммит содержащий в себе кандидата на рекомендацию.
    \item Размер максимального по мощности множества файлов из текущего коммита, каждый файл из которого присутствовал с кандидатом на рекомендацию в одном коммите.
    \item Размер минимального по мощности множества файлов из текущего коммита, каждый файл из которого присутствовал с кандидатом на рекомендацию в одном коммите.
    \item Максимальная длина наибольшего общего префикса абсолютного пути между файлом из текущего коммита и кандидатом на рекомендацию.
    \item Максимальная длина наибольшего общего префикса пути относительно корня репозитория между файлом из текущего коммита и кандидатом на рекомендацию.
\end{itemize}
\subsection{Оценка качества на созданном наборе данных}
\begin{table}[!h]
\caption{Точность части исследованных моделей на случайного леса}\label{rf-offline-result-table}
\centering
\begin{tabular}{|l|c|}\hline
\multicolumn{1}{|c|}{\textbf{Модель случайного леса}} & \textbf{Точность}\\\hline
Максимальная высота 11; число деревьев 50 & 0,56\\\hline
Максимальная высота 13; число деревьев 100 & \uline{0,61} \\\hline
Максимальная высота 16; число деревьев 100  & \textbf{0,63} \\\hline
\end{tabular}
\end{table}
\subsection{Оценка качества на основе собранной статистики}
\chapterconclusion